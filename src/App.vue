<template>
  <div id="app">
    <div class="font-robotoSerif bg-mainLight pt-10 pb-10">
      <div class="flex flex-col justify-center max-w-5xl w-2/3 m-auto">
        <div class="font-thin mt-8 mb-12 text-6xl">ЭТО ВАШЕ ПРОБНОЕ ЗАДАНИЕ</div>
        <div class="absolute font-thin text-pt16 transform -rotate-90 left-72/100 top-96">Frontend developer (VUE / JS)</div>
        <div class=" border-lightGray border-2 border-b-0 bg-white">
          <div class="absolute left-74/100 top-24">
            <svg xmlns="http://www.w3.org/2000/svg" width="237.765" height="110.998" viewBox="0 0 237.765 110.998">
              <g id="Group_3" data-name="Group 3" transform="translate(-542.478 -309.002)">
                <g id="Group_1" data-name="Group 1" transform="translate(542.5 322)">
                  <line id="Line_478" data-name="Line 478" x1="25.367" y1="22.642" transform="translate(3.354 0)" fill="none" stroke="#000" stroke-width="1"/>
                  <line id="Line_479" data-name="Line 479" x1="28.721" y2="1.258" transform="translate(0 41.09)" fill="none" stroke="#000" stroke-width="1"/>
                  <line id="Line_480" data-name="Line 480" x1="25.367" y2="26.834" transform="translate(3.354 57.862)" fill="none" stroke="#000" stroke-width="1"/>
                </g>
                <g id="Group_2" data-name="Group 2" transform="translate(751.5 322)">
                  <line id="Line_478-2" data-name="Line 478" y1="22.642" x2="25.367" transform="translate(0 0)" fill="none" stroke="#000" stroke-width="1"/>
                  <line id="Line_479-2" data-name="Line 479" x2="28.721" y2="1.258" transform="translate(0 41.09)" fill="none" stroke="#000" stroke-width="1"/>
                  <line id="Line_480-2" data-name="Line 480" x2="25.367" y2="26.834" transform="translate(0 57.862)" fill="none" stroke="#000" stroke-width="1"/>
                </g>
                <g id="github" transform="translate(599 276.668)">
                  <path id="Path_2275" data-name="Path 2275" d="M62.286,126.747c-2.33,0-4.66-1.206-7.073-3.619a2.433,2.433,0,0,1,3.441-3.441c1.485,1.486,2.673,2.207,3.632,2.207s2.147-.722,3.632-2.207a2.433,2.433,0,1,1,3.441,3.441C66.946,125.541,64.616,126.747,62.286,126.747ZM0,89.473a80.4,80.4,0,0,0,1.557,16.506,50.321,50.321,0,0,0,4.379,12.838,35.712,35.712,0,0,0,7.137,9.531,41.744,41.744,0,0,0,9.375,6.746,52.334,52.334,0,0,0,11.581,4.29A90.1,90.1,0,0,0,47.3,141.677q6.748.655,14.858.655t14.89-.655a90.056,90.056,0,0,0,13.3-2.292,53.035,53.035,0,0,0,11.614-4.29,42.116,42.116,0,0,0,9.44-6.746,35.363,35.363,0,0,0,7.169-9.531,51.124,51.124,0,0,0,4.412-12.838,78.813,78.813,0,0,0,1.59-16.506,41.724,41.724,0,0,0-10.121-28.1,25.022,25.022,0,0,0,1.006-3.6q.42-2.031.811-5.731a35.425,35.425,0,0,0-.292-8.548,47.034,47.034,0,0,0-2.563-9.891l-.973-.2a10.35,10.35,0,0,0-3.178.131,40.353,40.353,0,0,0-5.158,1.179,41.125,41.125,0,0,0-7.624,3.373,81.608,81.608,0,0,0-9.862,6.386,82.84,82.84,0,0,0-48.725,0A77.192,77.192,0,0,0,28,38.121a50.983,50.983,0,0,0-7.526-3.406,26.241,26.241,0,0,0-5.223-1.179,16.356,16.356,0,0,0-3.082-.164,4.66,4.66,0,0,0-1.006.229,48.505,48.505,0,0,0-2.6,9.891,34.293,34.293,0,0,0-.324,8.515,57.086,57.086,0,0,0,.843,5.764,24.339,24.339,0,0,0,1.038,3.6Q0,73.1,0,89.473Zm16.61,13.858q0-10.588,7.786-19.2a15.533,15.533,0,0,1,5.418-3.98,19.6,19.6,0,0,1,7.007-1.533,63.637,63.637,0,0,1,7.494.073q3.569.256,8.824.694t9.083.438q3.828,0,9.083-.438t8.824-.694a63.643,63.643,0,0,1,7.494-.073,19.894,19.894,0,0,1,7.04,1.533,15.446,15.446,0,0,1,5.449,3.98q7.786,8.616,7.786,19.2a42.918,42.918,0,0,1-1.3,11.062,31.606,31.606,0,0,1-3.276,8.141,16.9,16.9,0,0,1-5.547,5.55,37.134,37.134,0,0,1-6.91,3.5,40.416,40.416,0,0,1-8.629,1.935q-5.289.693-9.474.84t-10.543.146q-6.358,0-10.511-.146t-9.44-.84a40.42,40.42,0,0,1-8.629-1.935,37.127,37.127,0,0,1-6.91-3.5,16.886,16.886,0,0,1-5.547-5.55,31.61,31.61,0,0,1-3.277-8.141A42.959,42.959,0,0,1,16.61,103.331Zm14.533-3.82c0,6.45,3.486,11.679,7.786,11.679s7.786-5.229,7.786-11.679-3.486-11.679-7.786-11.679S31.143,93.061,31.143,99.511Zm46.714,0c0,6.45,3.486,11.679,7.786,11.679s7.786-5.229,7.786-11.679-3.486-11.679-7.786-11.679S77.857,93.061,77.857,99.511Z" transform="translate(0 0)" fill="#fff" stroke="#000" stroke-width="2"/>
                </g>
              </g>
            </svg>
          </div>
          <div class="-mt-0.5 border-lightGray border-t-2 p-8 bg-white"
               :class="[
                blockState_1 === 'full' && 'shadow-leftMainBlue',
                blockState_1 === 'empty' && 'shadow-leftLightGray',
                blockState_1 === 'filling' && 'shadow-leftMainGray',
                blockState_1 === 'correct' && 'shadow-leftMainGreen',
                blockState_1 === 'error' && 'shadow-leftMainPink'
                ]"
          >
            <div :class="{'opacity-30 pointer-events-none': buttonState === 'correct'}">
              <Input class="outline-none" ref="nameInput" @input="(v) => {
              this.name = v
              checkBlock1()
            }" title="Имя"></Input>
              <Input class="mt-4 outline-none" ref="telegramInput" @input="(v) => {
              this.tg = v
              checkBlock1()
            }" title="Ник в Telegram"></Input>
              <Input class="mt-4 outline-none" ref="repoLinkInput" @input="(v) => {
              this.repoLink = v
              checkBlock1()
            }" title="Ссылка на репозиторий этого задания"></Input>
              <Input class="mt-4 outline-none" ref="dontWantToDoInput" @input="(v) => {
              this.dontWantToDo = v
              checkBlock1()
            }" title="Что вы точно не хотите делать в работе, что вы делаете с неохотой?"></Input>
            </div>
          </div>
          <div class="mt-2 pt-6 p-8 bg-white"
               :class="[
                blockState_2 === 'full' && 'shadow-leftMainBlue',
                blockState_2 === 'empty' && 'shadow-leftLightGray',
                blockState_2 === 'filling' && 'shadow-leftMainGray',
                blockState_2 === 'correct' && 'shadow-leftMainGreen',
                blockState_2 === 'error' && 'shadow-leftMainPink'
                ]"
          >
            <div :class="{'opacity-30 pointer-events-none': buttonState === 'correct'}">
              <div class="mt-4 text-pt16 text-black">
                Как вы оцениваете своб способность взаимодействовать с дизайном?
              </div>
              <div class="text-pt16 mt-12 text-mainGray">
                А именно, работу с векторами, внимательность к деталям, возможность проявить инициативу - например,
                можете
                ли сверстать макет адаптируя его для мобильных устройств с макета под десктоп?
              </div>
              <Slider class="mt-4" @input="(v) => {
              this.designPower = v
              checkBlock2()
            }" ref="designSlider" :min=0 :value="designPower" :max=100></Slider>
              <Input class="outline-none" ref="designCommentInput" @input="(v) => this.designComment = v"
                     title="Ваш комментарий (По желанию)"></Input>
            </div>
          </div>
          <div class="mt-2 pt-6 p-8 bg-white"
               :class="[
                blockState_3 === 'full' && 'shadow-leftMainBlue',
                blockState_3 === 'empty' && 'shadow-leftLightGray',
                blockState_3 === 'filling' && 'shadow-leftMainGray',
                blockState_3 === 'correct' && 'shadow-leftMainGreen',
                blockState_3 === 'error' && 'shadow-leftMainPink'
                ]"
          >
            <div :class="{'opacity-30 pointer-events-none': buttonState === 'correct'}">
              <div class="text-pt16 text-black">
                Готовы ли работать с CSS анимацией?
              </div>
              <div class="text-pt16 mt-2 text-mainGray">
                Часто нужна несложная CSS анимация без сторонних библиотек для сопровождения какого-либо действия или
                плавной подачи информации, но без фанатизма ))
              </div>
              <Slider class="mt-4" @input="(v) => {
              this.animationsWill = v
              checkBlock3()
            }" ref="animationSlider" :min=0 :max=100 :value="animationsWill"></Slider>
              <Input class="outline-none" ref="animationCommentInput" @input="(v) => this.animationsComment = v"
                     title="Ваш комментарий (По желанию)"></Input>
            </div>
          </div>
          <div class="mt-2 pt-6 p-8 bg-white"
               :class="[
                blockState_4 === 'full' && 'shadow-leftMainBlue',
                blockState_4 === 'empty' && 'shadow-leftLightGray',
                blockState_4 === 'filling' && 'shadow-leftMainGray',
                blockState_4 === 'correct' && 'shadow-leftMainGreen',
                blockState_4 === 'error' && 'shadow-leftMainPink',
                ]"
          >
            <div :class="{'opacity-30 pointer-events-none': buttonState === 'correct'}">
              <Input class="outline-none" @input="(v) => {
              this.routines = v
              checkBlock4()
            }" ref="routineInput" title="Как относитесь к рутинной работе?"></Input>
              <div class="text-pt16 mt-2 text-mainGray">
                Бывают задачи интересные, а бывает, к примеру, нужно добавить на сайт пару новых языков в режиме
                copy/paste в файл локализации или помочь опубликовать пост в блоге - md файл из Гугл документа
              </div>
            </div>
          </div>
          <div class="mt-2 pt-6 p-8 bg-white"
               :class="[
                blockState_5 === 'full' && 'shadow-leftMainBlue',
                blockState_5 === 'empty' && 'shadow-leftLightGray',
                blockState_5 === 'filling' && 'shadow-leftMainGray',
                blockState_5 === 'correct' && 'shadow-leftMainGreen',
                blockState_5 === 'error' && 'shadow-leftMainPink'
                ]"
          >
            <div :class="{'opacity-30 pointer-events-none': buttonState === 'correct'}">
              <div class="relative h-full min-h-full bg-mainBlue w-2"></div>
              <Input class="outline-none blockElement" @input="(v) => {
              this.ifReadyForFull = v
              checkBlock5()
            }" ref="ifReadyForFullInput"
                     title="Готовы ли посвятить все 100% своего времени на работу с нашими задачами, не отвлекаясь на стороннюю разработку?"></Input>
            </div>
          </div>
        </div>
        <div class="bg-white">
          <button @click="sendForm" class="font-thin h-28 text-white -pt-4 text-pt20 w-full"
                  :class="[
                buttonState === 'full' && 'shadow-mainBlueButton bg-mainBlue',
                buttonState === 'empty' && 'shadow-mainGrayButton bg-mainGray',
                buttonState === 'correct' && 'shadow-mainGreenButton bg-mainGreen',
                ]"
          >
            <div class="relative left-6/10 top-1/4" v-if="buttonState === 'correct'">
              <svg xmlns="http://www.w3.org/2000/svg" width="38.713" height="26.757" viewBox="0 0 38.713 26.757">
                <path id="Path_1730" data-name="Path 1730" d="M1020.475,1262.209l12.664,12.664,24.635-24.635" transform="translate(-1019.768 -1249.53)" fill="none" stroke="#fff" stroke-width="2"/>
              </svg>
            </div>
            <div class="mb-8" :class="{'mt-8': buttonState !=='correct'}">
              {{buttonState !== 'correct' ? 'ОТПРАВИТЬ' : 'ОТПРАВЛЕНО'}}
            </div>

          </button>
        </div>
        <div class="text-pt16 text-center mt-16 text-lightText">LABORATORY OF MULTI-AGENT SYSTEMS</div>
      </div>
    </div>
  </div>
</template>

<script>
import Input from '@/components/uikit/Input/Input.vue'
import Slider from "@/components/uikit/Slider/Slider"
import axios from "axios"

export default {
  name: 'App',
  components: {Input, Slider},
  data: function () {
    return {
      name: '',
      tg: '',
      repoLink: '',
      dontWantToDo: '',
      designPower: 0,
      designComment: '',
      animationsWill: 0,
      animationsComment: '',
      routines: '',
      ifReadyForFull: '',
      blockState_1: 'empty',
      blockState_2: 'empty',
      blockState_3: 'empty',
      blockState_4: 'empty',
      blockState_5: 'empty',
      buttonState: 'empty'
    }
  },
  methods: {
    checkBlock1() {
      let counter = 0
      if (this.name !== '') {
        this.$refs.nameInput.setError('')
        counter++
      }
      if (this.tg !== '') {
        this.$refs.telegramInput.setError('')
        counter++
      }
      if (this.repoLink !== '') {
        this.$refs.repoLinkInput.setError('')
        counter++
      }
      if (this.dontWantToDo !== '') {
        this.$refs.dontWantToDoInput.setError('')
        counter++
      }

      switch (counter) {
        case 0:
          this.blockState_1 = 'empty'
          break
        case 4:
          this.blockState_1 = 'full'
          break
        default:
          this.blockState_1 = 'filling'
          break
      }
      this.buttonCheck()
    },
    checkBlock2() {
      this.blockState_2 = 'full'
      this.$refs.designSlider.setError('')
      this.buttonCheck()
    },
    checkBlock3() {
      this.blockState_3 = 'full'
      this.$refs.animationSlider.setError('')
      this.buttonCheck()
    },
    checkBlock4() {
      if (this.routines !== '') {
        this.blockState_4 = 'full'
        this.$refs.routineInput.setError('')
      } else
        this.blockState_4 = 'empty'
      this.buttonCheck()
    },
    checkBlock5() {
      if (this.ifReadyForFull !== '') {
        this.blockState_5 = 'full'
        this.$refs.ifReadyForFullInput.setError('')
      } else
        this.blockState_5 = 'empty'
      this.buttonCheck()
    },
    buttonCheck() {
      if (this.blockState_1 === 'full' &&
          this.blockState_2 === 'full' &&
          this.blockState_3 === 'full' &&
          this.blockState_4 === 'full' &&
          this.blockState_5 === 'full')
        this.buttonState = 'full'
    },
    sendForm: function () {
      if (this.buttonState !== 'correct') {
        let refs = this.$refs
        if (this.blockState_1 !== 'full') {
          this.blockState_1 = 'error'
          // Name field
          if (this.name === '')
            refs.nameInput.setError('Это поле необходимо заполнить')
          else
            refs.nameInput.setError('')
          // Telegram field
          if (this.tg === '')
            refs.telegramInput.setError('Это поле необходимо заполнить')
          else
            refs.telegramInput.setError('')
          // Project repository link
          if (this.repoLink === '')
            refs.repoLinkInput.setError('Это поле необходимо заполнить')
          else
            refs.repoLinkInput.setError('')
          // What you don't want to do on this work
          if (this.dontWantToDo === '')
            refs.dontWantToDoInput.setError('Это поле необходимо заполнить')
          else
            refs.dontWantToDoInput.setError('')
        }
        // Design block (only slider is checked)
        if (this.blockState_2 !== 'full') {
          refs.designSlider.setError('Необходимо указать положение')
          this.blockState_2 = 'error'
        } else {
          refs.designSlider.setError('')
        }
        // CSS Animations block (only slider is checker)
        if (this.blockState_3 !== 'full') {
          refs.animationSlider.setError('Необходимо указать положение')
          this.blockState_3 = 'error'
        } else
          refs.animationSlider.setError('')
        // Routines block (only one input checker)
        if (this.blockState_4 !== 'full') {
          refs.routineInput.setError('Это поле необходимо заполнить')
          this.blockState_4 = 'error'
        } else
          refs.routineInput.setError('')
        // Full free time on this work block (only one input checker)
        if (this.blockState_5 !== 'full') {
          refs.ifReadyForFullInput.setError('Это поле необходимо заполнить')
          this.blockState_5 = 'error'
        } else
          refs.ifReadyForFullInput.setError('')

        if (this.buttonState === 'full'
        ) {
          this.blockState_1 = 'correct'
          this.blockState_2 = 'correct'
          this.blockState_3 = 'correct'
          this.blockState_4 = 'correct'
          this.blockState_5 = 'correct'

          this.buttonState = 'correct'
        }

        axios
            .post(
                'https://script.google.com/macros/s/AKfycbwT5P8_PkFBy_vM5bhb_b-GsxQv7__15YilhVuzruB-JcFa1XXAp3kFS5_Y8a2lqg3K5A/exec',
                {
                  name: this.name,
                  telegram: this.telegram,
                  repo: this.repo,
                  sentFrom: window.location.href,
                  timestamp: Date.now(),
                  qNotWantedActivity: this.dontWantToDo,
                  qDesign: this.designPower,
                  qDesignComment: this.designComment,
                  qCssAnimation: this.animationsWill,
                  qCssAnimationComment: this.animationsComment,
                  qChores: this.routines,
                  qFreelance: this.ifReadyForFull
                },
                {
                  headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                  },
                }
            )
            .then((res) => {
              console.log(res)
              if(res.result === "success") {
                this.blockState_1 = 'correct'
                this.blockState_2 = 'correct'
                this.blockState_3 = 'correct'
                this.blockState_4 = 'correct'
                this.blockState_5 = 'correct'

                this.buttonState = 'correct'
              } else {
                alert('Something has gone wrong')
              }
            }).catch(e => alert(e))
      }
    }
  },
}
</script>

<style>
</style>
